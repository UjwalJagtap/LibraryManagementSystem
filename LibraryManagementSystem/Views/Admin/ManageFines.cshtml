<thead>
    <tr>
        <th>Book ID</th>
        <th>Book Title</th>
        <th>Student Name</th>
        <th>Request Date</th>
        <th>Due Date</th>
        <th>Return Date</th>
        <th>Fine Amount (INR)</th>
        <th>Actions</th>
    </tr>
</thead>
<tbody>
    @foreach (var fine in Model)
    {
        <tr>
            <td>@fine.BookId</td>
            <td>@fine.BookTitle</td>
            <td>@fine.StudentName</td>
            <td>@fine.RequestDate.ToString("dd MMM yyyy")</td>
            <td>@fine.DueDate.ToString("dd MMM yyyy")</td>
            <td>@(fine.ReturnDate.HasValue ? fine.ReturnDate?.ToString("dd MMM yyyy") : "<span class='badge bg-warning'>Not Returned</span>")</td>
            <td>@fine.FineAmount</td>
            <td>
                @if (fine.IsPaid)
                {
                    <span class="badge bg-success">Paid</span>
                }
                else
                {
                    <button class="btn btn-primary btn-sm" onclick="markFineAsPaid(@fine.BookId)">Mark as Paid</button>
                }
            </td>
        </tr>
    }
</tbody>
<script>
    function markFineAsPaid(bookId) {
        if (!confirm("Mark this fine as paid?")) return;
        $.ajax({
            url: "/Admin/PayFine",
            type: "POST",
            data: { bookId: bookId },
            success: function (response) {
                alert(response.message);
                loadContent('ManageFines'); // Reload the manage fines view
            },
            error: function () {
                alert("Error marking fine as paid.");
            }
        });
    }

</script>